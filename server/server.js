// implementation of the database logic